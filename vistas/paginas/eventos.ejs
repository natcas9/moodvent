<!-- visualizarEventos -->
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <%- include('../partials/head.ejs') %>
    <link rel="stylesheet" href="/static/css/visualizarEventos.css" />
    <title>Eventos</title>
  </head>

  <body>
    <div class="container">

      <!-- Filtrar  -->
      <form class="filtros" method="GET" action="/eventos/visualizar">
        <h3>Filtrar Eventos</h3>
        <label>Temática:
          <select name="tematica">
            <option value="">Todas</option>
            <option value="musica">Música</option>
            <option value="deporte">Deporte</option>
            <option value="arte">Arte</option>
          </select>
        </label>

        <label>Ubicación:
          <input type="text" name="ubicacion" placeholder="Ciudad o dirección" />
        </label>

        <label>Fecha:
          <input type="date" name="fecha" />
        </label>

        <label>Precio máximo:
          <input type="number" name="precio" placeholder="Máximo" />
        </label>

        <button type="submit">Aplicar filtros</button>
      </form>

      <!-- displaying the events thingys-->
      <div class="eventos">
        <% eventos.forEach(evento => { %>
          <div class="evento">
            <img
              src="<%= evento.imagen %>"
              alt="Imagen del evento"
              class="evento-img"
            />
            <div class="evento-info">
              <h2><%= evento.titulo %></h2>
              <p>Fecha: <%= evento.fecha %></p>
              <p>Precio: <%= evento.precio %></p>
              <p>Lugar: <%= evento.lugar %></p>
              <p>Estado de ánimo: <%= evento.estado_animo %></p>

            
              <a href="/eventos/editar/<%= evento.id %>" class="Editar">Editar</a>

              
              <form
                action="/eventos/eliminar/<%= evento.id %>"
                method="POST"
                style="display: inline"
              >
                <button
                  type="submit"
                  onclick="return confirm('¿Estás seguro de eliminar este evento?');"
                >
                  Eliminar
                </button>
              </form>

         
              <button
                class="mas-info"
                onclick="toggleDescripcion('<%= evento.id %>')"
              >
                Más info
              </button>

              <div class="descripcion" id="desc-<%= evento.id %>" style="display: none;">
                <p><%= evento.descripcion %></p>
              </div>
            </div>
          </div>
        <% }) %>
      </div>

    </div>


    <button onclick="window.location.href='/'" class="back-button">
      BACK
    </button>

    <script>
      function toggleDescripcion(id) {
        const desc = document.getElementById("desc-" + id);
        if (desc) {
          desc.style.display = desc.style.display === "none" ? "block" : "none";
        }
      }
    </script>
  </body>
</html>

